{"cells":[{"cell_type":"code","execution_count":2,"metadata":{},"outputs":[],"source":["import os \n","os.chdir('..')\n","from game.sotf import Sotf\n","from rl.MCTS import MCTS\n","import numpy as np \n","import pandas as pd \n","import random \n","import networkx as nx\n","peb = 3; arr = 3; nr_players = 3; field_size = 4;\n","game = Sotf(peb=peb,\n","            arr=arr,\n","            nr_players=nr_players,\n","            field_size=field_size,\n","            action_format='compressed')\n","MC = MCTS(game=game,\n","          exploration_epsilon=0.25,\n","          biasedness=1,\n","          optimizing_player=1)"]},{"cell_type":"code","execution_count":49,"metadata":{},"outputs":[{"output_type":"stream","name":"stdout","text":["1+1200.2130.3320+\n"]}],"source":["leaf_node, return_path = MC.select()  # selects any leaf node\n","if not leaf_node:\n","    print('leaf node is none??')\n","leaf_node\n","sel_node = MC.expand(node=leaf_node, return_random=True) # expands the graph \n","if not sel_node:\n","    print('sel_node is none??')\n","print(sel_node)\n","return_path.append(sel_node)\n","rewards = MC.rollout(edge=(leaf_node,sel_node))\n","MC.backpropagate(return_path=return_path, rewards=rewards, including_multiple_paths=True)"]},{"cell_type":"code","execution_count":6,"metadata":{},"outputs":[],"source":["node = '2+2000.2031.2100.3232.3320+10323.11003.33223'\n","game.initialize_from_state(node)"]},{"cell_type":"code","execution_count":6,"metadata":{},"outputs":[],"source":["converted_action = actio = [0, 2, -1, -1, -1, -1]"]},{"cell_type":"code","execution_count":8,"metadata":{},"outputs":[{"output_type":"stream","name":"stdout","text":["True False\n"]}],"source":["# self.action = converted_action\n","some_pebble = converted_action[0] >= 0\n","some_arrow = converted_action[2] >= 0\n","if game.either_peb_or_arrow:\n","    pebble_action = some_pebble and not some_arrow\n","    arrow_action = some_arrow and not some_pebble\n","else:\n","    pebble_action = some_pebble\n","    arrow_action = some_arrow\n","print(pebble_action, arrow_action)"]},{"cell_type":"code","execution_count":13,"metadata":{},"outputs":[],"source":["from game.sotf import next_player\n","self = game\n","cpl = self.current_player\n","npl = next_player(current_player=self.current_player, nr_players=self.nr_players)\n","# everything should be in a decoded form.\n","\n","# no action should also be allowed.\n","peb_none = [-1,-1]\n","arr_none = [-1,-1,-1,-1]\n","opts = [peb_none + arr_none]\n","        "]},{"cell_type":"code","execution_count":14,"metadata":{},"outputs":[{"output_type":"execute_result","data":{"text/plain":["3"]},"metadata":{},"execution_count":14}],"source":["npl"]},{"cell_type":"code","execution_count":null,"metadata":{},"outputs":[],"source":["self.pebbles_df[(self.pebbles_df.player==npl) & (self.pebbles_df.placed==0)]"]},{"cell_type":"code","execution_count":null,"metadata":{},"outputs":[],"source":["\n","if not self.pebbles_df[(self.pebbles_df.player==npl) & (self.pebbles_df.placed==0)].empty:\n","    # should the players turn also be included in the state of the game?\n","    # pebble options are all the vacant spots, if you have pebbles left.\n","    peb_opts = np.argwhere(self.state['pebbles']==0).tolist()\n","    for po in peb_opts:\n","        opts.append(po + arr_none)\n","if not self.arrows_df[(self.arrows_df.player==npl) & (self.arrows_df.placed==0)].empty:\n","    # arrow options are all the pairs of pebbles that conform to arrow-laying, if there are arrows left.\n","    pebs = self.pebbles_df.loc[self.pebbles_df.placed==1,['id','x','y']].astype(int).to_dict(orient='list')\n","    adj = self.state['arrows'][pebs['id']][:,pebs['id']]\n","    arr_opts = [[pebs['x'][link[0]], pebs['y'][link[0]], pebs['x'][link[1]], pebs['y'][link[1]]] for link in np.argwhere(adj==0) if link[0]!=link[1]]\n","    for ao in arr_opts:\n","        opts.append(peb_none + ao)\n","return {self.append_state_hash_from_action(action=op, action_player=cpl, turn_player=npl):op for op in opts}"]},{"cell_type":"code","execution_count":9,"metadata":{},"outputs":[{"output_type":"execute_result","data":{"text/plain":["   player    x    y  id  placed deg\n","0       2  0.0  0.0   0       1   0\n","1       2  0.0  3.0   1       1   1\n","2       2  1.0  0.0   2       1   0\n","3       3  2.0  3.0   3       1   2\n","4       3  3.0  2.0   4       1   0\n","0       1  NaN  NaN   5       0   0\n","1       1  NaN  NaN   6       0   0\n","2       1  NaN  NaN   7       0   0\n","3       3  NaN  NaN   8       0   0"],"text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>player</th>\n      <th>x</th>\n      <th>y</th>\n      <th>id</th>\n      <th>placed</th>\n      <th>deg</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>2</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>2</td>\n      <td>0.0</td>\n      <td>3.0</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>2</td>\n      <td>1.0</td>\n      <td>0.0</td>\n      <td>2</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>3</td>\n      <td>2.0</td>\n      <td>3.0</td>\n      <td>3</td>\n      <td>1</td>\n      <td>2</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>3</td>\n      <td>3.0</td>\n      <td>2.0</td>\n      <td>4</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>0</th>\n      <td>1</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>5</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>1</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>6</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>1</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>7</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>3</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>8</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n  </tbody>\n</table>\n</div>"},"metadata":{},"execution_count":9}],"source":["game.pebbles_df"]},{"cell_type":"code","execution_count":null,"metadata":{},"outputs":[],"source":[]},{"cell_type":"code","execution_count":null,"metadata":{},"outputs":[],"source":[]},{"cell_type":"code","execution_count":null,"metadata":{},"outputs":[],"source":[]},{"cell_type":"code","execution_count":null,"metadata":{},"outputs":[],"source":[]},{"cell_type":"code","execution_count":null,"metadata":{},"outputs":[],"source":[]},{"cell_type":"code","execution_count":56,"metadata":{},"outputs":[{"output_type":"execute_result","data":{"text/plain":["527"]},"metadata":{},"execution_count":56}],"source":["node_info = pd.DataFrame.from_dict({n:d for n,d in MC.g.nodes(data=True)}, orient='index')\n","len(node_info)"]},{"cell_type":"code","execution_count":59,"metadata":{},"outputs":[{"output_type":"execute_result","data":{"text/plain":["                                 rewards   N  terminal  leads_to_terminal  \\\n","1++                     [13.5, 9.0, 8.5]  31     False              False   \n","2+1000+                  [1.5, 0.0, 0.5]   2     False              False   \n","2+1010+                  [0.0, 1.0, 0.0]   1     False              False   \n","2+1020+                  [0.0, 0.5, 0.5]   1     False              False   \n","2+1100+                  [5.5, 2.0, 0.5]   8     False              False   \n","2+1120+                  [0.0, 0.5, 0.5]   1     False              False   \n","2+1130+                  [0.0, 0.5, 1.5]   2     False              False   \n","2+1200+                  [1.0, 0.5, 1.5]   3     False              False   \n","2+1220+                  [1.5, 0.5, 1.0]   3     False              False   \n","2+1230+                  [1.0, 1.5, 1.5]   4     False              False   \n","2+1330+                  [3.0, 2.0, 1.0]   6     False              False   \n","3+1000.2030+             [1.0, 0.0, 0.0]   1     False              False   \n","3+1000.2320+             [0.5, 0.0, 0.5]   1     False              False   \n","3+1130.2010+             [0.0, 0.0, 1.0]   1     False              False   \n","3+1130.2200+             [0.0, 0.5, 0.5]   1     False              False   \n","3+1100.2020+             [1.5, 0.0, 0.5]   2     False              False   \n","3+1100.2120+             [1.0, 0.0, 0.0]   1     False              False   \n","3+1100.2200+             [2.0, 0.0, 0.0]   2     False              False   \n","3+1100.2210+             [0.0, 1.0, 0.0]   1     False              False   \n","3+1100.2330+             [0.0, 1.0, 0.0]   1     False              False   \n","3+1330.2000+             [0.5, 0.5, 0.0]   1     False              False   \n","3+1330.2010+             [2.0, 0.0, 1.0]   3     False              False   \n","3+1330.2130+             [0.5, 1.5, 0.0]   2     False              False   \n","1+1330.2130.3000+        [0.0, 1.0, 0.0]   1     False              False   \n","1+1330.2131+33313        [0.5, 0.5, 0.0]   1     False              False   \n","1+1100.2330.3130+        [0.0, 1.0, 0.0]   1     False              False   \n","3+1200.2000+             [0.0, 0.0, 1.0]   1     False              False   \n","3+1200.2030+             [1.0, 0.0, 0.0]   1     False              False   \n","3+1200.2220+             [0.0, 0.5, 0.5]   1     False              False   \n","1+1330.2010.3030+        [1.0, 0.0, 1.0]   2     False              False   \n","1+1200.2220.3000+        [0.0, 0.5, 0.5]   1     False              False   \n","3+1010.2000+             [0.0, 1.0, 0.0]   1     False              False   \n","1+1101.2200+32010        [1.0, 0.0, 0.0]   1     False              False   \n","1+1100.2210.3330+        [0.0, 1.0, 0.0]   1     False              False   \n","2+1330.2010.3031+13303   [0.0, 0.0, 1.0]   1     False              False   \n","3+1020.2210+             [0.0, 0.5, 0.5]   1     False              False   \n","1+1000.2030.3320+        [1.0, 0.0, 0.0]   1     False              False   \n","1+1330.2000.3010+        [0.5, 0.5, 0.0]   1     False              False   \n","2+1320.1330.2130.3000+   [0.0, 1.0, 0.0]   1     False              False   \n","3+1230.2100+             [0.0, 0.0, 1.0]   1     False              False   \n","3+1230.2210+             [0.0, 1.0, 0.0]   1     False              False   \n","3+1230.2220+             [1.0, 0.0, 0.0]   1     False              False   \n","3+1230.2320+             [0.0, 0.5, 0.5]   1     False              False   \n","1+1130.2010.3310+        [0.0, 0.0, 1.0]   1     False              False   \n","1+1200.2000.3100+        [0.0, 0.0, 1.0]   1     False              False   \n","1+1100.2020.3110+        [0.5, 0.0, 0.5]   1     False              False   \n","1+1100.2020.3310+        [1.0, 0.0, 0.0]   1     False              False   \n","2+1101.2020.3310+13110   [1.0, 0.0, 0.0]   1     False              False   \n","1+1230.2320.3020+        [0.0, 0.5, 0.5]   1     False              False   \n","3+1120.2230+             [0.0, 0.5, 0.5]   1     False              False   \n","3+1220.2010+             [0.5, 0.0, 0.5]   1     False              False   \n","3+1220.2120+             [1.0, 0.0, 0.0]   1     False              False   \n","3+1220.2130+             [0.0, 0.5, 0.5]   1     False              False   \n","1+1230.2220.3120+        [1.0, 0.0, 0.0]   1     False              False   \n","1+1220.2120.3300+        [1.0, 0.0, 0.0]   1     False              False   \n","1+1230.2210.3100+        [0.0, 1.0, 0.0]   1     False              False   \n","1+1100.2120.3220+        [1.0, 0.0, 0.0]   1     False              False   \n","1+1220.2010.3310+        [0.5, 0.0, 0.5]   1     False              False   \n","\n","                         leaf  N_children  N_leads_to_terminal_child_edges  \\\n","1++                     False          17                                0   \n","2+1000+                 False          16                                0   \n","2+1010+                 False          16                                0   \n","2+1020+                 False          16                                0   \n","2+1100+                 False          16                                0   \n","2+1120+                 False          16                                0   \n","2+1130+                 False          16                                0   \n","2+1200+                 False          16                                0   \n","2+1220+                 False          16                                0   \n","2+1230+                 False          16                                0   \n","2+1330+                 False          16                                0   \n","3+1000.2030+            False          17                                0   \n","3+1000.2320+             True           0                                0   \n","3+1130.2010+            False          17                                0   \n","3+1130.2200+             True           0                                0   \n","3+1100.2020+            False          17                                0   \n","3+1100.2120+            False          17                                0   \n","3+1100.2200+            False          17                                0   \n","3+1100.2210+            False          17                                0   \n","3+1100.2330+            False          17                                0   \n","3+1330.2000+            False          17                                0   \n","3+1330.2010+            False          17                                0   \n","3+1330.2130+            False          17                                0   \n","1+1330.2130.3000+       False          20                                0   \n","1+1330.2131+33313        True           0                                0   \n","1+1100.2330.3130+        True           0                                0   \n","3+1200.2000+            False          17                                0   \n","3+1200.2030+             True           0                                0   \n","3+1200.2220+            False          17                                0   \n","1+1330.2010.3030+       False          20                                0   \n","1+1200.2220.3000+        True           0                                0   \n","3+1010.2000+             True           0                                0   \n","1+1101.2200+32010        True           0                                0   \n","1+1100.2210.3330+        True           0                                0   \n","2+1330.2010.3031+13303   True           0                                0   \n","3+1020.2210+             True           0                                0   \n","1+1000.2030.3320+        True           0                                0   \n","1+1330.2000.3010+        True           0                                0   \n","2+1320.1330.2130.3000+   True           0                                0   \n","3+1230.2100+             True           0                                0   \n","3+1230.2210+            False          17                                0   \n","3+1230.2220+            False          17                                0   \n","3+1230.2320+            False          17                                0   \n","1+1130.2010.3310+        True           0                                0   \n","1+1200.2000.3100+        True           0                                0   \n","1+1100.2020.3110+        True           0                                0   \n","1+1100.2020.3310+       False          20                                0   \n","2+1101.2020.3310+13110   True           0                                0   \n","1+1230.2320.3020+        True           0                                0   \n","3+1120.2230+             True           0                                0   \n","3+1220.2010+            False          17                                0   \n","3+1220.2120+            False          17                                0   \n","3+1220.2130+             True           0                                0   \n","1+1230.2220.3120+        True           0                                0   \n","1+1220.2120.3300+        True           0                                0   \n","1+1230.2210.3100+        True           0                                0   \n","1+1100.2120.3220+        True           0                                0   \n","1+1220.2010.3310+        True           0                                0   \n","\n","                        depth              parents  N_parents  current_player  \n","1++                         0                   []          0               1  \n","2+1000+                     1                [1++]          1               2  \n","2+1010+                     1                [1++]          1               2  \n","2+1020+                     1                [1++]          1               2  \n","2+1100+                     1                [1++]          1               2  \n","2+1120+                     1                [1++]          1               2  \n","2+1130+                     1                [1++]          1               2  \n","2+1200+                     1                [1++]          1               2  \n","2+1220+                     1                [1++]          1               2  \n","2+1230+                     1                [1++]          1               2  \n","2+1330+                     1                [1++]          1               2  \n","3+1000.2030+                2            [2+1000+]          1               3  \n","3+1000.2320+                2            [2+1000+]          1               3  \n","3+1130.2010+                2            [2+1130+]          1               3  \n","3+1130.2200+                2            [2+1130+]          1               3  \n","3+1100.2020+                2            [2+1100+]          1               3  \n","3+1100.2120+                2            [2+1100+]          1               3  \n","3+1100.2200+                2            [2+1100+]          1               3  \n","3+1100.2210+                2            [2+1100+]          1               3  \n","3+1100.2330+                2            [2+1100+]          1               3  \n","3+1330.2000+                2            [2+1330+]          1               3  \n","3+1330.2010+                2            [2+1330+]          1               3  \n","3+1330.2130+                2            [2+1330+]          1               3  \n","1+1330.2130.3000+           3       [3+1330.2130+]          1               1  \n","1+1330.2131+33313           3       [3+1330.2130+]          1               1  \n","1+1100.2330.3130+           3       [3+1100.2330+]          1               1  \n","3+1200.2000+                2            [2+1200+]          1               3  \n","3+1200.2030+                2            [2+1200+]          1               3  \n","3+1200.2220+                2            [2+1200+]          1               3  \n","1+1330.2010.3030+           3       [3+1330.2010+]          1               1  \n","1+1200.2220.3000+           3       [3+1200.2220+]          1               1  \n","3+1010.2000+                2            [2+1010+]          1               3  \n","1+1101.2200+32010           3       [3+1100.2200+]          1               1  \n","1+1100.2210.3330+           3       [3+1100.2210+]          1               1  \n","2+1330.2010.3031+13303      4  [1+1330.2010.3030+]          1               2  \n","3+1020.2210+                2            [2+1020+]          1               3  \n","1+1000.2030.3320+           3       [3+1000.2030+]          1               1  \n","1+1330.2000.3010+           3       [3+1330.2000+]          1               1  \n","2+1320.1330.2130.3000+      4  [1+1330.2130.3000+]          1               2  \n","3+1230.2100+                2            [2+1230+]          1               3  \n","3+1230.2210+                2            [2+1230+]          1               3  \n","3+1230.2220+                2            [2+1230+]          1               3  \n","3+1230.2320+                2            [2+1230+]          1               3  \n","1+1130.2010.3310+           3       [3+1130.2010+]          1               1  \n","1+1200.2000.3100+           3       [3+1200.2000+]          1               1  \n","1+1100.2020.3110+           3       [3+1100.2020+]          1               1  \n","1+1100.2020.3310+           3       [3+1100.2020+]          1               1  \n","2+1101.2020.3310+13110      4  [1+1100.2020.3310+]          1               2  \n","1+1230.2320.3020+           3       [3+1230.2320+]          1               1  \n","3+1120.2230+                2            [2+1120+]          1               3  \n","3+1220.2010+                2            [2+1220+]          1               3  \n","3+1220.2120+                2            [2+1220+]          1               3  \n","3+1220.2130+                2            [2+1220+]          1               3  \n","1+1230.2220.3120+           3       [3+1230.2220+]          1               1  \n","1+1220.2120.3300+           3       [3+1220.2120+]          1               1  \n","1+1230.2210.3100+           3       [3+1230.2210+]          1               1  \n","1+1100.2120.3220+           3       [3+1100.2120+]          1               1  \n","1+1220.2010.3310+           3       [3+1220.2010+]          1               1  "],"text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>rewards</th>\n      <th>N</th>\n      <th>terminal</th>\n      <th>leads_to_terminal</th>\n      <th>leaf</th>\n      <th>N_children</th>\n      <th>N_leads_to_terminal_child_edges</th>\n      <th>depth</th>\n      <th>parents</th>\n      <th>N_parents</th>\n      <th>current_player</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>1++</th>\n      <td>[13.5, 9.0, 8.5]</td>\n      <td>31</td>\n      <td>False</td>\n      <td>False</td>\n      <td>False</td>\n      <td>17</td>\n      <td>0</td>\n      <td>0</td>\n      <td>[]</td>\n      <td>0</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>2+1000+</th>\n      <td>[1.5, 0.0, 0.5]</td>\n      <td>2</td>\n      <td>False</td>\n      <td>False</td>\n      <td>False</td>\n      <td>16</td>\n      <td>0</td>\n      <td>1</td>\n      <td>[1++]</td>\n      <td>1</td>\n      <td>2</td>\n    </tr>\n    <tr>\n      <th>2+1010+</th>\n      <td>[0.0, 1.0, 0.0]</td>\n      <td>1</td>\n      <td>False</td>\n      <td>False</td>\n      <td>False</td>\n      <td>16</td>\n      <td>0</td>\n      <td>1</td>\n      <td>[1++]</td>\n      <td>1</td>\n      <td>2</td>\n    </tr>\n    <tr>\n      <th>2+1020+</th>\n      <td>[0.0, 0.5, 0.5]</td>\n      <td>1</td>\n      <td>False</td>\n      <td>False</td>\n      <td>False</td>\n      <td>16</td>\n      <td>0</td>\n      <td>1</td>\n      <td>[1++]</td>\n      <td>1</td>\n      <td>2</td>\n    </tr>\n    <tr>\n      <th>2+1100+</th>\n      <td>[5.5, 2.0, 0.5]</td>\n      <td>8</td>\n      <td>False</td>\n      <td>False</td>\n      <td>False</td>\n      <td>16</td>\n      <td>0</td>\n      <td>1</td>\n      <td>[1++]</td>\n      <td>1</td>\n      <td>2</td>\n    </tr>\n    <tr>\n      <th>2+1120+</th>\n      <td>[0.0, 0.5, 0.5]</td>\n      <td>1</td>\n      <td>False</td>\n      <td>False</td>\n      <td>False</td>\n      <td>16</td>\n      <td>0</td>\n      <td>1</td>\n      <td>[1++]</td>\n      <td>1</td>\n      <td>2</td>\n    </tr>\n    <tr>\n      <th>2+1130+</th>\n      <td>[0.0, 0.5, 1.5]</td>\n      <td>2</td>\n      <td>False</td>\n      <td>False</td>\n      <td>False</td>\n      <td>16</td>\n      <td>0</td>\n      <td>1</td>\n      <td>[1++]</td>\n      <td>1</td>\n      <td>2</td>\n    </tr>\n    <tr>\n      <th>2+1200+</th>\n      <td>[1.0, 0.5, 1.5]</td>\n      <td>3</td>\n      <td>False</td>\n      <td>False</td>\n      <td>False</td>\n      <td>16</td>\n      <td>0</td>\n      <td>1</td>\n      <td>[1++]</td>\n      <td>1</td>\n      <td>2</td>\n    </tr>\n    <tr>\n      <th>2+1220+</th>\n      <td>[1.5, 0.5, 1.0]</td>\n      <td>3</td>\n      <td>False</td>\n      <td>False</td>\n      <td>False</td>\n      <td>16</td>\n      <td>0</td>\n      <td>1</td>\n      <td>[1++]</td>\n      <td>1</td>\n      <td>2</td>\n    </tr>\n    <tr>\n      <th>2+1230+</th>\n      <td>[1.0, 1.5, 1.5]</td>\n      <td>4</td>\n      <td>False</td>\n      <td>False</td>\n      <td>False</td>\n      <td>16</td>\n      <td>0</td>\n      <td>1</td>\n      <td>[1++]</td>\n      <td>1</td>\n      <td>2</td>\n    </tr>\n    <tr>\n      <th>2+1330+</th>\n      <td>[3.0, 2.0, 1.0]</td>\n      <td>6</td>\n      <td>False</td>\n      <td>False</td>\n      <td>False</td>\n      <td>16</td>\n      <td>0</td>\n      <td>1</td>\n      <td>[1++]</td>\n      <td>1</td>\n      <td>2</td>\n    </tr>\n    <tr>\n      <th>3+1000.2030+</th>\n      <td>[1.0, 0.0, 0.0]</td>\n      <td>1</td>\n      <td>False</td>\n      <td>False</td>\n      <td>False</td>\n      <td>17</td>\n      <td>0</td>\n      <td>2</td>\n      <td>[2+1000+]</td>\n      <td>1</td>\n      <td>3</td>\n    </tr>\n    <tr>\n      <th>3+1000.2320+</th>\n      <td>[0.5, 0.0, 0.5]</td>\n      <td>1</td>\n      <td>False</td>\n      <td>False</td>\n      <td>True</td>\n      <td>0</td>\n      <td>0</td>\n      <td>2</td>\n      <td>[2+1000+]</td>\n      <td>1</td>\n      <td>3</td>\n    </tr>\n    <tr>\n      <th>3+1130.2010+</th>\n      <td>[0.0, 0.0, 1.0]</td>\n      <td>1</td>\n      <td>False</td>\n      <td>False</td>\n      <td>False</td>\n      <td>17</td>\n      <td>0</td>\n      <td>2</td>\n      <td>[2+1130+]</td>\n      <td>1</td>\n      <td>3</td>\n    </tr>\n    <tr>\n      <th>3+1130.2200+</th>\n      <td>[0.0, 0.5, 0.5]</td>\n      <td>1</td>\n      <td>False</td>\n      <td>False</td>\n      <td>True</td>\n      <td>0</td>\n      <td>0</td>\n      <td>2</td>\n      <td>[2+1130+]</td>\n      <td>1</td>\n      <td>3</td>\n    </tr>\n    <tr>\n      <th>3+1100.2020+</th>\n      <td>[1.5, 0.0, 0.5]</td>\n      <td>2</td>\n      <td>False</td>\n      <td>False</td>\n      <td>False</td>\n      <td>17</td>\n      <td>0</td>\n      <td>2</td>\n      <td>[2+1100+]</td>\n      <td>1</td>\n      <td>3</td>\n    </tr>\n    <tr>\n      <th>3+1100.2120+</th>\n      <td>[1.0, 0.0, 0.0]</td>\n      <td>1</td>\n      <td>False</td>\n      <td>False</td>\n      <td>False</td>\n      <td>17</td>\n      <td>0</td>\n      <td>2</td>\n      <td>[2+1100+]</td>\n      <td>1</td>\n      <td>3</td>\n    </tr>\n    <tr>\n      <th>3+1100.2200+</th>\n      <td>[2.0, 0.0, 0.0]</td>\n      <td>2</td>\n      <td>False</td>\n      <td>False</td>\n      <td>False</td>\n      <td>17</td>\n      <td>0</td>\n      <td>2</td>\n      <td>[2+1100+]</td>\n      <td>1</td>\n      <td>3</td>\n    </tr>\n    <tr>\n      <th>3+1100.2210+</th>\n      <td>[0.0, 1.0, 0.0]</td>\n      <td>1</td>\n      <td>False</td>\n      <td>False</td>\n      <td>False</td>\n      <td>17</td>\n      <td>0</td>\n      <td>2</td>\n      <td>[2+1100+]</td>\n      <td>1</td>\n      <td>3</td>\n    </tr>\n    <tr>\n      <th>3+1100.2330+</th>\n      <td>[0.0, 1.0, 0.0]</td>\n      <td>1</td>\n      <td>False</td>\n      <td>False</td>\n      <td>False</td>\n      <td>17</td>\n      <td>0</td>\n      <td>2</td>\n      <td>[2+1100+]</td>\n      <td>1</td>\n      <td>3</td>\n    </tr>\n    <tr>\n      <th>3+1330.2000+</th>\n      <td>[0.5, 0.5, 0.0]</td>\n      <td>1</td>\n      <td>False</td>\n      <td>False</td>\n      <td>False</td>\n      <td>17</td>\n      <td>0</td>\n      <td>2</td>\n      <td>[2+1330+]</td>\n      <td>1</td>\n      <td>3</td>\n    </tr>\n    <tr>\n      <th>3+1330.2010+</th>\n      <td>[2.0, 0.0, 1.0]</td>\n      <td>3</td>\n      <td>False</td>\n      <td>False</td>\n      <td>False</td>\n      <td>17</td>\n      <td>0</td>\n      <td>2</td>\n      <td>[2+1330+]</td>\n      <td>1</td>\n      <td>3</td>\n    </tr>\n    <tr>\n      <th>3+1330.2130+</th>\n      <td>[0.5, 1.5, 0.0]</td>\n      <td>2</td>\n      <td>False</td>\n      <td>False</td>\n      <td>False</td>\n      <td>17</td>\n      <td>0</td>\n      <td>2</td>\n      <td>[2+1330+]</td>\n      <td>1</td>\n      <td>3</td>\n    </tr>\n    <tr>\n      <th>1+1330.2130.3000+</th>\n      <td>[0.0, 1.0, 0.0]</td>\n      <td>1</td>\n      <td>False</td>\n      <td>False</td>\n      <td>False</td>\n      <td>20</td>\n      <td>0</td>\n      <td>3</td>\n      <td>[3+1330.2130+]</td>\n      <td>1</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>1+1330.2131+33313</th>\n      <td>[0.5, 0.5, 0.0]</td>\n      <td>1</td>\n      <td>False</td>\n      <td>False</td>\n      <td>True</td>\n      <td>0</td>\n      <td>0</td>\n      <td>3</td>\n      <td>[3+1330.2130+]</td>\n      <td>1</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>1+1100.2330.3130+</th>\n      <td>[0.0, 1.0, 0.0]</td>\n      <td>1</td>\n      <td>False</td>\n      <td>False</td>\n      <td>True</td>\n      <td>0</td>\n      <td>0</td>\n      <td>3</td>\n      <td>[3+1100.2330+]</td>\n      <td>1</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>3+1200.2000+</th>\n      <td>[0.0, 0.0, 1.0]</td>\n      <td>1</td>\n      <td>False</td>\n      <td>False</td>\n      <td>False</td>\n      <td>17</td>\n      <td>0</td>\n      <td>2</td>\n      <td>[2+1200+]</td>\n      <td>1</td>\n      <td>3</td>\n    </tr>\n    <tr>\n      <th>3+1200.2030+</th>\n      <td>[1.0, 0.0, 0.0]</td>\n      <td>1</td>\n      <td>False</td>\n      <td>False</td>\n      <td>True</td>\n      <td>0</td>\n      <td>0</td>\n      <td>2</td>\n      <td>[2+1200+]</td>\n      <td>1</td>\n      <td>3</td>\n    </tr>\n    <tr>\n      <th>3+1200.2220+</th>\n      <td>[0.0, 0.5, 0.5]</td>\n      <td>1</td>\n      <td>False</td>\n      <td>False</td>\n      <td>False</td>\n      <td>17</td>\n      <td>0</td>\n      <td>2</td>\n      <td>[2+1200+]</td>\n      <td>1</td>\n      <td>3</td>\n    </tr>\n    <tr>\n      <th>1+1330.2010.3030+</th>\n      <td>[1.0, 0.0, 1.0]</td>\n      <td>2</td>\n      <td>False</td>\n      <td>False</td>\n      <td>False</td>\n      <td>20</td>\n      <td>0</td>\n      <td>3</td>\n      <td>[3+1330.2010+]</td>\n      <td>1</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>1+1200.2220.3000+</th>\n      <td>[0.0, 0.5, 0.5]</td>\n      <td>1</td>\n      <td>False</td>\n      <td>False</td>\n      <td>True</td>\n      <td>0</td>\n      <td>0</td>\n      <td>3</td>\n      <td>[3+1200.2220+]</td>\n      <td>1</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>3+1010.2000+</th>\n      <td>[0.0, 1.0, 0.0]</td>\n      <td>1</td>\n      <td>False</td>\n      <td>False</td>\n      <td>True</td>\n      <td>0</td>\n      <td>0</td>\n      <td>2</td>\n      <td>[2+1010+]</td>\n      <td>1</td>\n      <td>3</td>\n    </tr>\n    <tr>\n      <th>1+1101.2200+32010</th>\n      <td>[1.0, 0.0, 0.0]</td>\n      <td>1</td>\n      <td>False</td>\n      <td>False</td>\n      <td>True</td>\n      <td>0</td>\n      <td>0</td>\n      <td>3</td>\n      <td>[3+1100.2200+]</td>\n      <td>1</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>1+1100.2210.3330+</th>\n      <td>[0.0, 1.0, 0.0]</td>\n      <td>1</td>\n      <td>False</td>\n      <td>False</td>\n      <td>True</td>\n      <td>0</td>\n      <td>0</td>\n      <td>3</td>\n      <td>[3+1100.2210+]</td>\n      <td>1</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>2+1330.2010.3031+13303</th>\n      <td>[0.0, 0.0, 1.0]</td>\n      <td>1</td>\n      <td>False</td>\n      <td>False</td>\n      <td>True</td>\n      <td>0</td>\n      <td>0</td>\n      <td>4</td>\n      <td>[1+1330.2010.3030+]</td>\n      <td>1</td>\n      <td>2</td>\n    </tr>\n    <tr>\n      <th>3+1020.2210+</th>\n      <td>[0.0, 0.5, 0.5]</td>\n      <td>1</td>\n      <td>False</td>\n      <td>False</td>\n      <td>True</td>\n      <td>0</td>\n      <td>0</td>\n      <td>2</td>\n      <td>[2+1020+]</td>\n      <td>1</td>\n      <td>3</td>\n    </tr>\n    <tr>\n      <th>1+1000.2030.3320+</th>\n      <td>[1.0, 0.0, 0.0]</td>\n      <td>1</td>\n      <td>False</td>\n      <td>False</td>\n      <td>True</td>\n      <td>0</td>\n      <td>0</td>\n      <td>3</td>\n      <td>[3+1000.2030+]</td>\n      <td>1</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>1+1330.2000.3010+</th>\n      <td>[0.5, 0.5, 0.0]</td>\n      <td>1</td>\n      <td>False</td>\n      <td>False</td>\n      <td>True</td>\n      <td>0</td>\n      <td>0</td>\n      <td>3</td>\n      <td>[3+1330.2000+]</td>\n      <td>1</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>2+1320.1330.2130.3000+</th>\n      <td>[0.0, 1.0, 0.0]</td>\n      <td>1</td>\n      <td>False</td>\n      <td>False</td>\n      <td>True</td>\n      <td>0</td>\n      <td>0</td>\n      <td>4</td>\n      <td>[1+1330.2130.3000+]</td>\n      <td>1</td>\n      <td>2</td>\n    </tr>\n    <tr>\n      <th>3+1230.2100+</th>\n      <td>[0.0, 0.0, 1.0]</td>\n      <td>1</td>\n      <td>False</td>\n      <td>False</td>\n      <td>True</td>\n      <td>0</td>\n      <td>0</td>\n      <td>2</td>\n      <td>[2+1230+]</td>\n      <td>1</td>\n      <td>3</td>\n    </tr>\n    <tr>\n      <th>3+1230.2210+</th>\n      <td>[0.0, 1.0, 0.0]</td>\n      <td>1</td>\n      <td>False</td>\n      <td>False</td>\n      <td>False</td>\n      <td>17</td>\n      <td>0</td>\n      <td>2</td>\n      <td>[2+1230+]</td>\n      <td>1</td>\n      <td>3</td>\n    </tr>\n    <tr>\n      <th>3+1230.2220+</th>\n      <td>[1.0, 0.0, 0.0]</td>\n      <td>1</td>\n      <td>False</td>\n      <td>False</td>\n      <td>False</td>\n      <td>17</td>\n      <td>0</td>\n      <td>2</td>\n      <td>[2+1230+]</td>\n      <td>1</td>\n      <td>3</td>\n    </tr>\n    <tr>\n      <th>3+1230.2320+</th>\n      <td>[0.0, 0.5, 0.5]</td>\n      <td>1</td>\n      <td>False</td>\n      <td>False</td>\n      <td>False</td>\n      <td>17</td>\n      <td>0</td>\n      <td>2</td>\n      <td>[2+1230+]</td>\n      <td>1</td>\n      <td>3</td>\n    </tr>\n    <tr>\n      <th>1+1130.2010.3310+</th>\n      <td>[0.0, 0.0, 1.0]</td>\n      <td>1</td>\n      <td>False</td>\n      <td>False</td>\n      <td>True</td>\n      <td>0</td>\n      <td>0</td>\n      <td>3</td>\n      <td>[3+1130.2010+]</td>\n      <td>1</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>1+1200.2000.3100+</th>\n      <td>[0.0, 0.0, 1.0]</td>\n      <td>1</td>\n      <td>False</td>\n      <td>False</td>\n      <td>True</td>\n      <td>0</td>\n      <td>0</td>\n      <td>3</td>\n      <td>[3+1200.2000+]</td>\n      <td>1</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>1+1100.2020.3110+</th>\n      <td>[0.5, 0.0, 0.5]</td>\n      <td>1</td>\n      <td>False</td>\n      <td>False</td>\n      <td>True</td>\n      <td>0</td>\n      <td>0</td>\n      <td>3</td>\n      <td>[3+1100.2020+]</td>\n      <td>1</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>1+1100.2020.3310+</th>\n      <td>[1.0, 0.0, 0.0]</td>\n      <td>1</td>\n      <td>False</td>\n      <td>False</td>\n      <td>False</td>\n      <td>20</td>\n      <td>0</td>\n      <td>3</td>\n      <td>[3+1100.2020+]</td>\n      <td>1</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>2+1101.2020.3310+13110</th>\n      <td>[1.0, 0.0, 0.0]</td>\n      <td>1</td>\n      <td>False</td>\n      <td>False</td>\n      <td>True</td>\n      <td>0</td>\n      <td>0</td>\n      <td>4</td>\n      <td>[1+1100.2020.3310+]</td>\n      <td>1</td>\n      <td>2</td>\n    </tr>\n    <tr>\n      <th>1+1230.2320.3020+</th>\n      <td>[0.0, 0.5, 0.5]</td>\n      <td>1</td>\n      <td>False</td>\n      <td>False</td>\n      <td>True</td>\n      <td>0</td>\n      <td>0</td>\n      <td>3</td>\n      <td>[3+1230.2320+]</td>\n      <td>1</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>3+1120.2230+</th>\n      <td>[0.0, 0.5, 0.5]</td>\n      <td>1</td>\n      <td>False</td>\n      <td>False</td>\n      <td>True</td>\n      <td>0</td>\n      <td>0</td>\n      <td>2</td>\n      <td>[2+1120+]</td>\n      <td>1</td>\n      <td>3</td>\n    </tr>\n    <tr>\n      <th>3+1220.2010+</th>\n      <td>[0.5, 0.0, 0.5]</td>\n      <td>1</td>\n      <td>False</td>\n      <td>False</td>\n      <td>False</td>\n      <td>17</td>\n      <td>0</td>\n      <td>2</td>\n      <td>[2+1220+]</td>\n      <td>1</td>\n      <td>3</td>\n    </tr>\n    <tr>\n      <th>3+1220.2120+</th>\n      <td>[1.0, 0.0, 0.0]</td>\n      <td>1</td>\n      <td>False</td>\n      <td>False</td>\n      <td>False</td>\n      <td>17</td>\n      <td>0</td>\n      <td>2</td>\n      <td>[2+1220+]</td>\n      <td>1</td>\n      <td>3</td>\n    </tr>\n    <tr>\n      <th>3+1220.2130+</th>\n      <td>[0.0, 0.5, 0.5]</td>\n      <td>1</td>\n      <td>False</td>\n      <td>False</td>\n      <td>True</td>\n      <td>0</td>\n      <td>0</td>\n      <td>2</td>\n      <td>[2+1220+]</td>\n      <td>1</td>\n      <td>3</td>\n    </tr>\n    <tr>\n      <th>1+1230.2220.3120+</th>\n      <td>[1.0, 0.0, 0.0]</td>\n      <td>1</td>\n      <td>False</td>\n      <td>False</td>\n      <td>True</td>\n      <td>0</td>\n      <td>0</td>\n      <td>3</td>\n      <td>[3+1230.2220+]</td>\n      <td>1</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>1+1220.2120.3300+</th>\n      <td>[1.0, 0.0, 0.0]</td>\n      <td>1</td>\n      <td>False</td>\n      <td>False</td>\n      <td>True</td>\n      <td>0</td>\n      <td>0</td>\n      <td>3</td>\n      <td>[3+1220.2120+]</td>\n      <td>1</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>1+1230.2210.3100+</th>\n      <td>[0.0, 1.0, 0.0]</td>\n      <td>1</td>\n      <td>False</td>\n      <td>False</td>\n      <td>True</td>\n      <td>0</td>\n      <td>0</td>\n      <td>3</td>\n      <td>[3+1230.2210+]</td>\n      <td>1</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>1+1100.2120.3220+</th>\n      <td>[1.0, 0.0, 0.0]</td>\n      <td>1</td>\n      <td>False</td>\n      <td>False</td>\n      <td>True</td>\n      <td>0</td>\n      <td>0</td>\n      <td>3</td>\n      <td>[3+1100.2120+]</td>\n      <td>1</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>1+1220.2010.3310+</th>\n      <td>[0.5, 0.0, 0.5]</td>\n      <td>1</td>\n      <td>False</td>\n      <td>False</td>\n      <td>True</td>\n      <td>0</td>\n      <td>0</td>\n      <td>3</td>\n      <td>[3+1220.2010+]</td>\n      <td>1</td>\n      <td>1</td>\n    </tr>\n  </tbody>\n</table>\n</div>"},"metadata":{},"execution_count":59}],"source":["node_info[node_info.N>0]"]},{"cell_type":"code","execution_count":18,"metadata":{},"outputs":[],"source":["sel_node = MC.expand(node=leaf_node, return_random=True) # expands the graph \n","if not sel_node:\n","    print('sel_node is none??')"]},{"cell_type":"code","execution_count":11,"metadata":{},"outputs":[],"source":["return_path.append(sel_node)"]},{"cell_type":"code","execution_count":12,"metadata":{},"outputs":[],"source":["rewards = MC.rollout(edge=(leaf_node,sel_node))"]},{"cell_type":"code","execution_count":13,"metadata":{},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([1., 0., 0.])"]},"metadata":{},"execution_count":13}],"source":["rewards"]},{"source":["THIS MUST NOT HAPPEN!!! NO MORE PEBBLES IS AN INACCEPTIBLE PRITNT STATEMENT"],"cell_type":"markdown","metadata":{}},{"cell_type":"code","execution_count":14,"metadata":{},"outputs":[],"source":["MC.backpropagate(return_path=return_path, rewards=rewards, including_multiple_paths=True)"]},{"cell_type":"code","execution_count":15,"metadata":{},"outputs":[{"output_type":"execute_result","data":{"text/plain":["                      rewards  N  terminal  leads_to_terminal   leaf  \\\n","1++           [2.0, 0.0, 0.0]  2     False              False  False   \n","2++           [0.0, 0.0, 0.0]  0     False              False   True   \n","2+1000+       [0.0, 0.0, 0.0]  0     False              False   True   \n","2+1010+       [0.0, 0.0, 0.0]  0     False              False   True   \n","2+1020+       [0.0, 0.0, 0.0]  0     False              False   True   \n","2+1030+       [1.0, 0.0, 0.0]  1     False              False  False   \n","2+1100+       [0.0, 0.0, 0.0]  0     False              False   True   \n","2+1110+       [0.0, 0.0, 0.0]  0     False              False   True   \n","2+1120+       [0.0, 0.0, 0.0]  0     False              False   True   \n","2+1130+       [0.0, 0.0, 0.0]  0     False              False   True   \n","2+1200+       [0.0, 0.0, 0.0]  0     False              False   True   \n","2+1210+       [1.0, 0.0, 0.0]  1     False              False   True   \n","2+1220+       [0.0, 0.0, 0.0]  0     False              False   True   \n","2+1230+       [0.0, 0.0, 0.0]  0     False              False   True   \n","2+1300+       [0.0, 0.0, 0.0]  0     False              False   True   \n","2+1310+       [0.0, 0.0, 0.0]  0     False              False   True   \n","2+1320+       [0.0, 0.0, 0.0]  0     False              False   True   \n","2+1330+       [0.0, 0.0, 0.0]  0     False              False   True   \n","3+1030+       [0.0, 0.0, 0.0]  0     False              False   True   \n","3+1030.2000+  [0.0, 0.0, 0.0]  0     False              False   True   \n","\n","              N_children  N_leads_to_terminal_child_edges  depth    parents  \\\n","1++                   17                                0      0         []   \n","2++                    0                                0      1      [1++]   \n","2+1000+                0                                0      1      [1++]   \n","2+1010+                0                                0      1      [1++]   \n","2+1020+                0                                0      1      [1++]   \n","2+1030+               16                                0      1      [1++]   \n","2+1100+                0                                0      1      [1++]   \n","2+1110+                0                                0      1      [1++]   \n","2+1120+                0                                0      1      [1++]   \n","2+1130+                0                                0      1      [1++]   \n","2+1200+                0                                0      1      [1++]   \n","2+1210+                0                                0      1      [1++]   \n","2+1220+                0                                0      1      [1++]   \n","2+1230+                0                                0      1      [1++]   \n","2+1300+                0                                0      1      [1++]   \n","2+1310+                0                                0      1      [1++]   \n","2+1320+                0                                0      1      [1++]   \n","2+1330+                0                                0      1      [1++]   \n","3+1030+                0                                0      2  [2+1030+]   \n","3+1030.2000+           0                                0      2  [2+1030+]   \n","\n","              N_parents  current_player  \n","1++                   0               1  \n","2++                   1               2  \n","2+1000+               1               2  \n","2+1010+               1               2  \n","2+1020+               1               2  \n","2+1030+               1               2  \n","2+1100+               1               2  \n","2+1110+               1               2  \n","2+1120+               1               2  \n","2+1130+               1               2  \n","2+1200+               1               2  \n","2+1210+               1               2  \n","2+1220+               1               2  \n","2+1230+               1               2  \n","2+1300+               1               2  \n","2+1310+               1               2  \n","2+1320+               1               2  \n","2+1330+               1               2  \n","3+1030+               1               3  \n","3+1030.2000+          1               3  "],"text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>rewards</th>\n      <th>N</th>\n      <th>terminal</th>\n      <th>leads_to_terminal</th>\n      <th>leaf</th>\n      <th>N_children</th>\n      <th>N_leads_to_terminal_child_edges</th>\n      <th>depth</th>\n      <th>parents</th>\n      <th>N_parents</th>\n      <th>current_player</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>1++</th>\n      <td>[2.0, 0.0, 0.0]</td>\n      <td>2</td>\n      <td>False</td>\n      <td>False</td>\n      <td>False</td>\n      <td>17</td>\n      <td>0</td>\n      <td>0</td>\n      <td>[]</td>\n      <td>0</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>2++</th>\n      <td>[0.0, 0.0, 0.0]</td>\n      <td>0</td>\n      <td>False</td>\n      <td>False</td>\n      <td>True</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>[1++]</td>\n      <td>1</td>\n      <td>2</td>\n    </tr>\n    <tr>\n      <th>2+1000+</th>\n      <td>[0.0, 0.0, 0.0]</td>\n      <td>0</td>\n      <td>False</td>\n      <td>False</td>\n      <td>True</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>[1++]</td>\n      <td>1</td>\n      <td>2</td>\n    </tr>\n    <tr>\n      <th>2+1010+</th>\n      <td>[0.0, 0.0, 0.0]</td>\n      <td>0</td>\n      <td>False</td>\n      <td>False</td>\n      <td>True</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>[1++]</td>\n      <td>1</td>\n      <td>2</td>\n    </tr>\n    <tr>\n      <th>2+1020+</th>\n      <td>[0.0, 0.0, 0.0]</td>\n      <td>0</td>\n      <td>False</td>\n      <td>False</td>\n      <td>True</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>[1++]</td>\n      <td>1</td>\n      <td>2</td>\n    </tr>\n    <tr>\n      <th>2+1030+</th>\n      <td>[1.0, 0.0, 0.0]</td>\n      <td>1</td>\n      <td>False</td>\n      <td>False</td>\n      <td>False</td>\n      <td>16</td>\n      <td>0</td>\n      <td>1</td>\n      <td>[1++]</td>\n      <td>1</td>\n      <td>2</td>\n    </tr>\n    <tr>\n      <th>2+1100+</th>\n      <td>[0.0, 0.0, 0.0]</td>\n      <td>0</td>\n      <td>False</td>\n      <td>False</td>\n      <td>True</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>[1++]</td>\n      <td>1</td>\n      <td>2</td>\n    </tr>\n    <tr>\n      <th>2+1110+</th>\n      <td>[0.0, 0.0, 0.0]</td>\n      <td>0</td>\n      <td>False</td>\n      <td>False</td>\n      <td>True</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>[1++]</td>\n      <td>1</td>\n      <td>2</td>\n    </tr>\n    <tr>\n      <th>2+1120+</th>\n      <td>[0.0, 0.0, 0.0]</td>\n      <td>0</td>\n      <td>False</td>\n      <td>False</td>\n      <td>True</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>[1++]</td>\n      <td>1</td>\n      <td>2</td>\n    </tr>\n    <tr>\n      <th>2+1130+</th>\n      <td>[0.0, 0.0, 0.0]</td>\n      <td>0</td>\n      <td>False</td>\n      <td>False</td>\n      <td>True</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>[1++]</td>\n      <td>1</td>\n      <td>2</td>\n    </tr>\n    <tr>\n      <th>2+1200+</th>\n      <td>[0.0, 0.0, 0.0]</td>\n      <td>0</td>\n      <td>False</td>\n      <td>False</td>\n      <td>True</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>[1++]</td>\n      <td>1</td>\n      <td>2</td>\n    </tr>\n    <tr>\n      <th>2+1210+</th>\n      <td>[1.0, 0.0, 0.0]</td>\n      <td>1</td>\n      <td>False</td>\n      <td>False</td>\n      <td>True</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>[1++]</td>\n      <td>1</td>\n      <td>2</td>\n    </tr>\n    <tr>\n      <th>2+1220+</th>\n      <td>[0.0, 0.0, 0.0]</td>\n      <td>0</td>\n      <td>False</td>\n      <td>False</td>\n      <td>True</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>[1++]</td>\n      <td>1</td>\n      <td>2</td>\n    </tr>\n    <tr>\n      <th>2+1230+</th>\n      <td>[0.0, 0.0, 0.0]</td>\n      <td>0</td>\n      <td>False</td>\n      <td>False</td>\n      <td>True</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>[1++]</td>\n      <td>1</td>\n      <td>2</td>\n    </tr>\n    <tr>\n      <th>2+1300+</th>\n      <td>[0.0, 0.0, 0.0]</td>\n      <td>0</td>\n      <td>False</td>\n      <td>False</td>\n      <td>True</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>[1++]</td>\n      <td>1</td>\n      <td>2</td>\n    </tr>\n    <tr>\n      <th>2+1310+</th>\n      <td>[0.0, 0.0, 0.0]</td>\n      <td>0</td>\n      <td>False</td>\n      <td>False</td>\n      <td>True</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>[1++]</td>\n      <td>1</td>\n      <td>2</td>\n    </tr>\n    <tr>\n      <th>2+1320+</th>\n      <td>[0.0, 0.0, 0.0]</td>\n      <td>0</td>\n      <td>False</td>\n      <td>False</td>\n      <td>True</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>[1++]</td>\n      <td>1</td>\n      <td>2</td>\n    </tr>\n    <tr>\n      <th>2+1330+</th>\n      <td>[0.0, 0.0, 0.0]</td>\n      <td>0</td>\n      <td>False</td>\n      <td>False</td>\n      <td>True</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>[1++]</td>\n      <td>1</td>\n      <td>2</td>\n    </tr>\n    <tr>\n      <th>3+1030+</th>\n      <td>[0.0, 0.0, 0.0]</td>\n      <td>0</td>\n      <td>False</td>\n      <td>False</td>\n      <td>True</td>\n      <td>0</td>\n      <td>0</td>\n      <td>2</td>\n      <td>[2+1030+]</td>\n      <td>1</td>\n      <td>3</td>\n    </tr>\n    <tr>\n      <th>3+1030.2000+</th>\n      <td>[0.0, 0.0, 0.0]</td>\n      <td>0</td>\n      <td>False</td>\n      <td>False</td>\n      <td>True</td>\n      <td>0</td>\n      <td>0</td>\n      <td>2</td>\n      <td>[2+1030+]</td>\n      <td>1</td>\n      <td>3</td>\n    </tr>\n  </tbody>\n</table>\n</div>"},"metadata":{},"execution_count":15}],"source":["node_info = pd.DataFrame.from_dict({n:d for n,d in MC.g.nodes(data=True)}, orient='index')\n","node_info.head(20)"]},{"cell_type":"code","execution_count":null,"metadata":{},"outputs":[],"source":[]},{"cell_type":"code","execution_count":10,"metadata":{},"outputs":[],"source":["dig = nx.from_numpy_matrix(A=MC.game.state_terminal[\"arrows\"], create_using=nx.DiGraph)\n"]},{"cell_type":"code","execution_count":null,"metadata":{},"outputs":[],"source":[]},{"source":["try both, with random initialization and without"],"cell_type":"markdown","metadata":{}},{"cell_type":"code","execution_count":2,"metadata":{},"outputs":[{"output_type":"execute_result","data":{"text/plain":["'2+1300+'"]},"metadata":{},"execution_count":2}],"source":["opts = game.options()\n","chos = random.choice([o for o in opts])\n","chos"]},{"cell_type":"code","execution_count":2,"metadata":{},"outputs":[],"source":["game.initialize_from_state('2+1010+')"]},{"cell_type":"code","execution_count":48,"metadata":{},"outputs":[],"source":["path = [game.state_hash]"]},{"cell_type":"code","execution_count":59,"metadata":{},"outputs":[{"output_type":"error","ename":"KeyboardInterrupt","evalue":"","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mKeyboardInterrupt\u001b[0m                         Traceback (most recent call last)","\u001b[0;32m<ipython-input-59-ecaa4566c9ba>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m\u001b[0m\n\u001b[1;32m      2\u001b[0m \u001b[0mchos\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mrandom\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mchoice\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mo\u001b[0m \u001b[0;32mfor\u001b[0m \u001b[0mo\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mopts\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      3\u001b[0m \u001b[0mpath\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mappend\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mchos\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 4\u001b[0;31m \u001b[0m_\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0m_\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mgame_over\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0m_\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mgame\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mstep\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0maction\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mopts\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mchos\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      5\u001b[0m \u001b[0mprint\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mgame_over\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      6\u001b[0m \u001b[0mprint\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mchos\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m~/sotf/game/sotf.py\u001b[0m in \u001b[0;36mstep\u001b[0;34m(self, action)\u001b[0m\n\u001b[1;32m    261\u001b[0m                 \u001b[0;31m# print('before extinction the scores are ')\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    262\u001b[0m                 \u001b[0;31m# print(self.scores)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 263\u001b[0;31m                 \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mextinction_waves\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    264\u001b[0m                 \u001b[0;31m# set scores\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    265\u001b[0m                 \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0massign_scores\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m~/sotf/game/sotf.py\u001b[0m in \u001b[0;36mextinction_waves\u001b[0;34m(self)\u001b[0m\n\u001b[1;32m    105\u001b[0m         \u001b[0;31m# for i in range(10): #ToDo: Needs to change\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    106\u001b[0m         \u001b[0;32mwhile\u001b[0m \u001b[0;32mnot\u001b[0m \u001b[0mfinal_flag\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 107\u001b[0;31m             \u001b[0mfinal_flag\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mextinction_wave\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    108\u001b[0m         \u001b[0;32mreturn\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    109\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m~/sotf/game/sotf.py\u001b[0m in \u001b[0;36mextinction_wave\u001b[0;34m(self)\u001b[0m\n\u001b[1;32m    121\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    122\u001b[0m                     \u001b[0mstubs\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0marrows_df\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m'source_id'\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m==\u001b[0m\u001b[0mrow\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m\"id\"\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;34m|\u001b[0m \u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0marrows_df\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m'target_id'\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m==\u001b[0m\u001b[0mrow\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m\"id\"\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 123\u001b[0;31m                     \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0marrows_df\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mloc\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mstubs\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m'placed'\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;36m0\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    124\u001b[0m                     \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0marrows_df\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mloc\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mstubs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m'source_id'\u001b[0m\u001b[0;34m]\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mnp\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mnan\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    125\u001b[0m                     \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0marrows_df\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mloc\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mstubs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m'target_id'\u001b[0m\u001b[0;34m]\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mnp\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mnan\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m~/sotf/.venv/lib/python3.6/site-packages/pandas/core/indexing.py\u001b[0m in \u001b[0;36m__setitem__\u001b[0;34m(self, key, value)\u001b[0m\n\u001b[1;32m    668\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    669\u001b[0m         \u001b[0miloc\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m \u001b[0;32mif\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mname\u001b[0m \u001b[0;34m==\u001b[0m \u001b[0;34m\"iloc\"\u001b[0m \u001b[0;32melse\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mobj\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0miloc\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 670\u001b[0;31m         \u001b[0miloc\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_setitem_with_indexer\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mindexer\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mvalue\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    671\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    672\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0m_validate_key\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mkey\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0maxis\u001b[0m\u001b[0;34m:\u001b[0m \u001b[0mint\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m~/sotf/.venv/lib/python3.6/site-packages/pandas/core/indexing.py\u001b[0m in \u001b[0;36m_setitem_with_indexer\u001b[0;34m(self, indexer, value)\u001b[0m\n\u001b[1;32m   1761\u001b[0m                 \u001b[0;31m# scalar value\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1762\u001b[0m                 \u001b[0;32mfor\u001b[0m \u001b[0mloc\u001b[0m \u001b[0;32min\u001b[0m \u001b[0milocs\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1763\u001b[0;31m                     \u001b[0misetter\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mloc\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mvalue\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1764\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1765\u001b[0m         \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m~/sotf/.venv/lib/python3.6/site-packages/pandas/core/indexing.py\u001b[0m in \u001b[0;36misetter\u001b[0;34m(loc, v)\u001b[0m\n\u001b[1;32m   1687\u001b[0m                     \u001b[0;31m# set the item, possibly having a dtype change\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1688\u001b[0m                     \u001b[0mser\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mser\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcopy\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1689\u001b[0;31m                     \u001b[0mser\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_mgr\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mser\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_mgr\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0msetitem\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mindexer\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mplane_indexer\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mvalue\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mv\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1690\u001b[0m                     \u001b[0mser\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_maybe_update_cacher\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mclear\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;32mTrue\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1691\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m~/sotf/.venv/lib/python3.6/site-packages/pandas/core/internals/managers.py\u001b[0m in \u001b[0;36msetitem\u001b[0;34m(self, indexer, value)\u001b[0m\n\u001b[1;32m    532\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    533\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0msetitem\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mindexer\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mvalue\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;34m->\u001b[0m \u001b[0;34m\"BlockManager\"\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 534\u001b[0;31m         \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mapply\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m\"setitem\"\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mindexer\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mindexer\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mvalue\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mvalue\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    535\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    536\u001b[0m     def putmask(\n","\u001b[0;32m~/sotf/.venv/lib/python3.6/site-packages/pandas/core/internals/managers.py\u001b[0m in \u001b[0;36mapply\u001b[0;34m(self, f, align_keys, **kwargs)\u001b[0m\n\u001b[1;32m    404\u001b[0m                 \u001b[0mapplied\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mb\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mapply\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mf\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    405\u001b[0m             \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 406\u001b[0;31m                 \u001b[0mapplied\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mgetattr\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mb\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mf\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    407\u001b[0m             \u001b[0mresult_blocks\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0m_extend_blocks\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mapplied\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mresult_blocks\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    408\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m~/sotf/.venv/lib/python3.6/site-packages/pandas/core/internals/blocks.py\u001b[0m in \u001b[0;36msetitem\u001b[0;34m(self, indexer, value)\u001b[0m\n\u001b[1;32m    893\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0mtranspose\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    894\u001b[0m             \u001b[0mvalues\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mvalues\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mT\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 895\u001b[0;31m         \u001b[0mblock\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mmake_block\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mvalues\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    896\u001b[0m         \u001b[0;32mreturn\u001b[0m \u001b[0mblock\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    897\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m~/sotf/.venv/lib/python3.6/site-packages/pandas/core/internals/blocks.py\u001b[0m in \u001b[0;36mmake_block\u001b[0;34m(self, values, placement)\u001b[0m\n\u001b[1;32m    252\u001b[0m             \u001b[0mvalues\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0m_block_shape\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mvalues\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mndim\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mndim\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    253\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 254\u001b[0;31m         \u001b[0;32mreturn\u001b[0m \u001b[0mmake_block\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mvalues\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mplacement\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mplacement\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mndim\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mndim\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    255\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    256\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0mmake_block_same_class\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mvalues\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mplacement\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;32mNone\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mndim\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;32mNone\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m~/sotf/.venv/lib/python3.6/site-packages/pandas/core/internals/blocks.py\u001b[0m in \u001b[0;36mmake_block\u001b[0;34m(values, placement, klass, ndim, dtype)\u001b[0m\n\u001b[1;32m   2713\u001b[0m     \u001b[0;32mif\u001b[0m \u001b[0mklass\u001b[0m \u001b[0;32mis\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   2714\u001b[0m         \u001b[0mdtype\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mdtype\u001b[0m \u001b[0;32mor\u001b[0m \u001b[0mvalues\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mdtype\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 2715\u001b[0;31m         \u001b[0mklass\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mget_block_type\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mvalues\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mdtype\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   2716\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   2717\u001b[0m     \u001b[0;32melif\u001b[0m \u001b[0mklass\u001b[0m \u001b[0;32mis\u001b[0m \u001b[0mDatetimeTZBlock\u001b[0m \u001b[0;32mand\u001b[0m \u001b[0;32mnot\u001b[0m \u001b[0mis_datetime64tz_dtype\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mvalues\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mdtype\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m~/sotf/.venv/lib/python3.6/site-packages/pandas/core/internals/blocks.py\u001b[0m in \u001b[0;36mget_block_type\u001b[0;34m(values, dtype)\u001b[0m\n\u001b[1;32m   2669\u001b[0m     \u001b[0mvtype\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mdtype\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mtype\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   2670\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 2671\u001b[0;31m     \u001b[0;32mif\u001b[0m \u001b[0mis_sparse\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mdtype\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   2672\u001b[0m         \u001b[0;31m# Need this first(ish) so that Sparse[datetime] is sparse\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   2673\u001b[0m         \u001b[0mcls\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mExtensionBlock\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m~/sotf/.venv/lib/python3.6/site-packages/pandas/core/dtypes/common.py\u001b[0m in \u001b[0;36mis_sparse\u001b[0;34m(arr)\u001b[0m\n\u001b[1;32m    264\u001b[0m     \u001b[0mReturns\u001b[0m\u001b[0;31m \u001b[0m\u001b[0;31m`\u001b[0m\u001b[0;32mFalse\u001b[0m\u001b[0;31m`\u001b[0m \u001b[0;32mif\u001b[0m \u001b[0mthe\u001b[0m \u001b[0mparameter\u001b[0m \u001b[0mhas\u001b[0m \u001b[0mmore\u001b[0m \u001b[0mthan\u001b[0m \u001b[0mone\u001b[0m \u001b[0mdimension\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    265\u001b[0m     \"\"\"\n\u001b[0;32m--> 266\u001b[0;31m     \u001b[0;32mfrom\u001b[0m \u001b[0mpandas\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcore\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0marrays\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0msparse\u001b[0m \u001b[0;32mimport\u001b[0m \u001b[0mSparseDtype\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    267\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    268\u001b[0m     \u001b[0mdtype\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mgetattr\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0marr\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m\"dtype\"\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0marr\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/lib/python3.6/importlib/_bootstrap.py\u001b[0m in \u001b[0;36m_handle_fromlist\u001b[0;34m(module, fromlist, import_, recursive)\u001b[0m\n","\u001b[0;31mKeyboardInterrupt\u001b[0m: "]}],"source":["opts = game.options()\n","chos = random.choice([o for o in opts]) \n","path.append(chos)\n","_, _, game_over, _ = game.step(action=opts[chos])\n","print(game_over)\n","print(chos)\n","print(opts[chos])\n","print(game.state['pebbles']) "]},{"cell_type":"code","execution_count":60,"metadata":{},"outputs":[{"output_type":"execute_result","data":{"text/plain":["['2+1010+',\n"," '3+1010.2030+',\n"," '1+1011.2030+30301',\n"," '2+1011.2030+30301',\n"," '3+1011.2030.2110+30301',\n"," '1+1011.2030.2110+30301',\n"," '2+1011.2031.2110+10103.30301',\n"," '3+1011.2032.2110+10103.21103.30301',\n"," '1+1011.2032.2111+10103.21103.30301.30311',\n"," '2+1011.1230.2032.2111+10103.21103.30301.30311',\n"," '3+1011.1230.2032.2111.2200+10103.21103.30301.30311',\n"," '1+1011.1231.2032.2111.2200+10103.21103.30301.30311.32023']"]},"metadata":{},"execution_count":60}],"source":["path"]},{"cell_type":"code","execution_count":3,"metadata":{},"outputs":[],"source":["state = '3+1011.1230.2032.2111.2200+10103.21103.30301.30311'\n","game.initialize_from_state(state)\n","opts = game.options()\n","chosen =  '1+1011.1231.2032.2111.2200+10103.21103.30301.30311.32023'\n","action = opts[chosen]"]},{"cell_type":"code","execution_count":4,"metadata":{},"outputs":[],"source":[" _, _, game_over, _ = game.step(action=action)"]},{"cell_type":"code","execution_count":6,"metadata":{},"outputs":[{"output_type":"execute_result","data":{"text/plain":["{'pebbles': array([[0, 0, 0, 2],\n","        [0, 0, 0, 0],\n","        [0, 0, 0, 0],\n","        [0, 0, 0, 0]]),\n"," 'arrows': array([[0, 0, 0, 0, 0, 0, 0, 0, 0],\n","        [0, 0, 0, 0, 0, 0, 0, 0, 0],\n","        [0, 0, 0, 0, 0, 0, 0, 0, 0],\n","        [0, 0, 0, 0, 0, 0, 0, 0, 0],\n","        [0, 0, 0, 0, 0, 0, 0, 0, 0],\n","        [0, 0, 0, 0, 0, 0, 0, 0, 0],\n","        [0, 0, 0, 0, 0, 0, 0, 0, 0],\n","        [0, 0, 0, 0, 0, 0, 0, 0, 0],\n","        [0, 0, 0, 0, 0, 0, 0, 0, 0]])}"]},"metadata":{},"execution_count":6}],"source":["game.state"]},{"cell_type":"code","execution_count":7,"metadata":{},"outputs":[],"source":["self = game\n","converted_action = self.convert_action(ac=action)\n","self.action = converted_action\n","some_pebble = converted_action[0] >= 0\n","some_arrow = converted_action[2] >= 0\n","if self.either_peb_or_arrow:\n","    pebble_action = some_pebble and not some_arrow\n","    arrow_action = some_arrow and not some_pebble\n","else:\n","    pebble_action = some_pebble\n","    arrow_action = some_arrow"]},{"cell_type":"code","execution_count":8,"metadata":{},"outputs":[{"output_type":"stream","name":"stdout","text":["True True\n"]}],"source":["source = converted_action[2:4]\n","target = converted_action[4:6]\n","# is this a possible move\n","source_occupied = self.peb_state[source[0], source[1]] != 0\n","target_occupied = self.peb_state[target[0], target[1]] != 0\n","print(source_occupied, target_occupied)"]},{"cell_type":"code","execution_count":9,"metadata":{},"outputs":[{"output_type":"execute_result","data":{"text/plain":["   id  player  source_id  target_id  placed\n","4   8       3        NaN        NaN       0"],"text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>id</th>\n      <th>player</th>\n      <th>source_id</th>\n      <th>target_id</th>\n      <th>placed</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>4</th>\n      <td>8</td>\n      <td>3</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>0</td>\n    </tr>\n  </tbody>\n</table>\n</div>"},"metadata":{},"execution_count":9}],"source":["temp_df = self.arrows_df[(self.arrows_df['placed'] == 0) & (self.arrows_df['player'] == self.current_player)]\n","temp_df"]},{"cell_type":"code","execution_count":10,"metadata":{},"outputs":[],"source":["temp_source = self.pebbles_df[\n","    (self.pebbles_df['x'] == source[0]) & (self.pebbles_df['y'] == source[1])]\n","temp_target = self.pebbles_df[\n","    (self.pebbles_df['x'] == target[0]) & (self.pebbles_df['y'] == target[1])]"]},{"cell_type":"code","execution_count":11,"metadata":{},"outputs":[],"source":["self.arr_state[temp_source.id.values[0], temp_target.id.values[0]] = self.current_player\n","self.state['arrows'] = self.arr_state"]},{"cell_type":"code","execution_count":21,"metadata":{},"outputs":[{"output_type":"execute_result","data":{"text/plain":["4"]},"metadata":{},"execution_count":21}],"source":["temp_source.id.values[0]"]},{"cell_type":"code","execution_count":12,"metadata":{},"outputs":[],"source":["self.arrows_df.loc[self.arrows_df.id==temp_df.id.values[0], 'source_id'] = temp_source.id.values[0]\n","self.arrows_df.loc[self.arrows_df.id==temp_df.id.values[0], 'target_id'] = temp_target.id.values[0]\n","self.arrows_df.loc[self.arrows_df.id==temp_df.id.values[0], 'placed'] = 1"]},{"cell_type":"code","execution_count":13,"metadata":{},"outputs":[],"source":["self.pebbles_df.loc[self.pebbles_df.id == temp_target.id.values[0], 'deg'] = 1 + int(self.pebbles_df.loc[self.pebbles_df.id == temp_target.id.values[0], 'deg'].values)"]},{"cell_type":"code","execution_count":17,"metadata":{},"outputs":[],"source":["npl = 1\n","self.state_hash = self.append_state_hash_from_action(action=converted_action, action_player=self.current_player, turn_player=npl)\n"]},{"cell_type":"code","execution_count":20,"metadata":{},"outputs":[{"output_type":"execute_result","data":{"text/plain":["True"]},"metadata":{},"execution_count":20}],"source":["self.last_move()"]},{"cell_type":"code","execution_count":22,"metadata":{},"outputs":[],"source":["self.stage = \"extinction-triggered\"\n","final_flag = False"]},{"cell_type":"code","execution_count":32,"metadata":{},"outputs":[{"output_type":"execute_result","data":{"text/plain":["False"]},"metadata":{},"execution_count":32}],"source":["max(self.pebbles_df[self.pebbles_df.placed==1].deg.astype(int))==min(self.pebbles_df[self.pebbles_df.placed==1].deg.astype(int))"]},{"cell_type":"code","execution_count":33,"metadata":{},"outputs":[],"source":["weakest_df = self.pebbles_df[self.pebbles_df.deg.astype(int) == min(self.pebbles_df[self.pebbles_df.placed==1].deg.astype(int))]"]},{"cell_type":"code","execution_count":46,"metadata":{},"outputs":[{"output_type":"execute_result","data":{"text/plain":["0    False\n","1    False\n","2    False\n","3    False\n","0    False\n","1    False\n","2    False\n","3    False\n","4     True\n","dtype: bool"]},"metadata":{},"execution_count":46}],"source":["row = weakest_df.loc[weakest_df.placed==1,:]\n","stubs = (self.arrows_df['source_id']==row[\"id\"].values[0]) | (self.arrows_df['target_id']==row[\"id\"].values[0])\n","stubs "]},{"cell_type":"code","execution_count":64,"metadata":{},"outputs":[],"source":["\n","self.pebbles_df.loc[self.pebbles_df.id == int(row[\"id\"]), \"x\"] = np.nan\n","self.pebbles_df.loc[self.pebbles_df.id == int(row[\"id\"]), \"y\"] = np.nan\n","self.pebbles_df.loc[self.pebbles_df.id == int(row[\"id\"]), \"placed\"] = 0\n","self.pebbles_df.loc[self.pebbles_df.id == int(row[\"id\"]), \"deg\"] = 0"]},{"cell_type":"code","execution_count":65,"metadata":{},"outputs":[{"output_type":"execute_result","data":{"text/plain":["   player    x    y  id  placed deg\n","0       1  0.0  1.0   0       1   1\n","1       1  2.0  3.0   1       1   1\n","2       2  0.0  3.0   2       1   2\n","3       2  1.0  1.0   3       1   1\n","4       2  NaN  NaN   4       0   0\n","0       1  NaN  NaN   5       0   0\n","1       3  NaN  NaN   6       0   0\n","2       3  NaN  NaN   7       0   0\n","3       3  NaN  NaN   8       0   0"],"text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>player</th>\n      <th>x</th>\n      <th>y</th>\n      <th>id</th>\n      <th>placed</th>\n      <th>deg</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>1</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>1</td>\n      <td>2.0</td>\n      <td>3.0</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>2</td>\n      <td>0.0</td>\n      <td>3.0</td>\n      <td>2</td>\n      <td>1</td>\n      <td>2</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>2</td>\n      <td>1.0</td>\n      <td>1.0</td>\n      <td>3</td>\n      <td>1</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>2</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>4</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>0</th>\n      <td>1</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>5</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>3</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>6</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>3</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>7</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>3</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>8</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n  </tbody>\n</table>\n</div>"},"metadata":{},"execution_count":65}],"source":["self.pebbles_df"]},{"cell_type":"code","execution_count":null,"metadata":{},"outputs":[],"source":["# update self.arrows_df\n","self.arrows_df.loc[self.arrows_df.id==temp_df.id.values[0], 'source_id'] = temp_source.id.values[0]\n","self.arrows_df.loc[self.arrows_df.id==temp_df.id.values[0], 'target_id'] = temp_target.id.values[0]\n","self.arrows_df.loc[self.arrows_df.id==temp_df.id.values[0], 'placed'] = 1\n","\n","# update self.pebbles_df (update degree) .. only target degree should increase\n","self.pebbles_df.loc[temp_target.id.values[0], 'deg'] = self.pebbles_df.loc[temp_target.iloc[0, 0], 'deg'] + 1\n","                        # else:\n","                        #     print('you must not place more than one arrow between any pair of pebbles.')"]},{"cell_type":"code","execution_count":40,"metadata":{},"outputs":[{"output_type":"execute_result","data":{"text/plain":["True"]},"metadata":{},"execution_count":40}],"source":["self.peb_state[converted_action[0], converted_action[1]]==0"]},{"cell_type":"code","execution_count":41,"metadata":{},"outputs":[],"source":["self.peb_state[converted_action[0], converted_action[1]] = self.current_player\n","self.state['pebbles'] = self.peb_state"]},{"cell_type":"code","execution_count":47,"metadata":{},"outputs":[{"output_type":"execute_result","data":{"text/plain":["4"]},"metadata":{},"execution_count":47}],"source":["temp_df.id.values[0]"]},{"cell_type":"code","execution_count":null,"metadata":{},"outputs":[],"source":["if converted_action[0]<self.field_size and converted_action[1]<self.field_size:\n","# we are within the bounds\n","# choose a pebble place it and update peb state and arr state\n","temp_df = self.pebbles_df[(self.pebbles_df['placed'] == 0) & (self.pebbles_df['player'] == self.current_player)]\n","\n","if len(temp_df)==0 :\n","    # no more pebbles for this player\n","    print(\"no more pebbles\")\n","else:\n","    # still some pebbles for this player\n","\n","    # may the pebble be placed or not\n","    if self.peb_state[converted_action[0], converted_action[1]]==0:\n","        # update pebbles state\n","        self.peb_state[converted_action[0], converted_action[1]] = self.current_player\n","        self.state['pebbles'] = self.peb_state\n","\n","        # update pebbles dataframe\n","        self.pebbles_df.loc[self.pebbles_df.id==temp_df.id[0], 'x'] = converted_action[0]\n","        self.pebbles_df.loc[self.pebbles_df.id==temp_df.id[0], 'y'] = converted_action[1]\n","        self.pebbles_df.loc[self.pebbles_df.id==temp_df.id[0], 'placed'] = 1\n","\n","\n","    else:\n","        # pebble may not be placed\n","        print(\"there is already a pebble here\")\n"]},{"cell_type":"code","execution_count":null,"metadata":{},"outputs":[],"source":["leaf_node, return_path = MC.select()  \n","# sel_node = MC.expand(node=leaf_node, return_random=True) # expands the graph \n","# return_path.append(sel_node)\n","# reward = MC.rollout(edge=(leaf_node,sel_node))\n","# MC.backpropagate(return_path=return_path, reward=reward, including_multiple_paths=True)\n","       "]},{"cell_type":"code","execution_count":null,"metadata":{},"outputs":[],"source":[""]}],"nbformat":4,"nbformat_minor":2,"metadata":{"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.6.9-final"},"orig_nbformat":2,"kernelspec":{"name":"venv","display_name":"venv"}}}